<!DOCTYPE html>
<html>
<head>
    <title>Super Contribution Analysis</title>
    <script>
        // Sample data format for import
        const sampleData = {
            dates: ["16.03", "20.03", "07.03", "18.05", "21.06", "26.07", "14.08", "19.09", "29.10", "05.10", "04.11", "29.11", "16.12"],
            amounts: [55.41, 82.50, 300, 350, 55, 350, 41, 300, 12.15, 301.14, 636.28, 350, 87.11]
        };

        let contributionData = {};
        let paymentCycle = "";
        let annualIncome = 0;
        let superRate = 11.0;

        function importData() {
            const dataInput = document.getElementById('dataInput').value;
            try {
                const data = JSON.parse(dataInput);
                if (data.dates && data.amounts && data.dates.length === data.amounts.length) {
                    contributionData = {};
                    data.dates.forEach((date, index) => {
                        contributionData[date] = data.amounts[index];
                    });
                    updateCalendar();
                    updateAnalysis();
                }
            } catch (e) {
                alert('Invalid data format. Please use the sample format shown.');
            }
        }

        function setPaymentCycle() {
            paymentCycle = document.getElementById('paymentCycle').value;
            annualIncome = parseFloat(document.getElementById('annualIncome').value) || 0;
            superRate = parseFloat(document.getElementById('superRate').value) || 11.0;
            updateCalendar();
            updateAnalysis();
        }

        function getExpectedContribution(cycle) {
            const annualSuper = annualIncome * (superRate / 100);
            switch (cycle) {
                case 'weekly': return annualSuper / 52;
                case 'biweekly': return annualSuper / 26;
                case 'quadweekly': return annualSuper / 13;
                case 'monthly': return annualSuper / 12;
                case 'quarterly': return annualSuper / 4;
                case 'halfyear': return annualSuper / 2;
                case 'yearly': return annualSuper;
                default: return 0;
            }
        }

        function updateAnalysis() {
            const analysis = document.getElementById('analysis');
            const expected = getExpectedContribution(paymentCycle);
            const total = Object.values(contributionData).reduce((sum, val) => sum + val, 0);

            let html = `<h3>Analysis</h3>
                       <p>Annual Income: $${annualIncome.toLocaleString()}</p>
                       <p>Super Rate: ${superRate}%</p>
                       <p>Expected Annual Super: $${(annualIncome * superRate / 100).toLocaleString()}</p>
                       <p>Expected ${paymentCycle} contribution: $${expected.toFixed(2)}</p>
                       <p>Total contributions to date: $${total.toFixed(2)}</p>`;

            // Monthly breakdown
            html += '<h4>Monthly Analysis</h4><table>';
            let monthlyTotals = {};

            Object.entries(contributionData).forEach(([date, amount]) => {
                const [day, month] = date.split('.');
                monthlyTotals[month] = (monthlyTotals[month] || 0) + amount;
            });

            Object.entries(monthlyTotals).sort().forEach(([month, total]) => {
                const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                    'July', 'August', 'September', 'October', 'November', 'December'];
                const expectedMonthly = annualIncome * superRate / 100 / 12;
                const variance = total - expectedMonthly;

                html += `<tr>
                    <td>${monthNames[parseInt(month) - 1]}</td>
                    <td>$${total.toFixed(2)}</td>
                    <td>Expected: $${expectedMonthly.toFixed(2)}</td>
                    <td>Variance: ${variance > 0 ? '+' : ''}$${variance.toFixed(2)}</td>
                </tr>`;
            });

            html += '</table>';
            analysis.innerHTML = html;
        }

        function createCalendar() {
            const months = [
                "January", "February", "March", "April",
                "May", "June", "July", "August",
                "September", "October", "November", "December"
            ];
            const container = document.getElementById("calendar");

            for (let year = 2024; year <= 2024; year++) {
                for (let month = 0; month < 12; month++) {
                    const monthDiv = document.createElement("div");
                    monthDiv.className = "month";

                    const monthTitle = document.createElement("div");
                    monthTitle.className = "month-title";
                    monthTitle.textContent = `${months[month]} ${year}`;
                    monthDiv.appendChild(monthTitle);

                    const weekdays = document.createElement("div");
                    weekdays.className = "weekdays";
                    "Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(",").forEach(day => {
                        const dayDiv = document.createElement("div");
                        dayDiv.textContent = day;
                        weekdays.appendChild(dayDiv);
                    });
                    monthDiv.appendChild(weekdays);

                    const daysDiv = document.createElement("div");
                    daysDiv.className = "days";

                    const firstDay = new Date(year, month, 1);
                    const lastDay = new Date(year, month + 1, 0);

                    for (let i = 0; i < firstDay.getDay(); i++) {
                        const emptyDay = document.createElement("div");
                        emptyDay.className = "day";
                        daysDiv.appendChild(emptyDay);
                    }

                    for (let day = 1; day <= lastDay.getDate(); day++) {
                        const dayDiv = document.createElement("div");
                        dayDiv.className = "day";
                        dayDiv.textContent = day;

                        const currentDate = new Date(year, month, day);
                        const dateStr = `${day.toString().padStart(2, '0')}.${(month + 1).toString().padStart(2, '0')}`;

                        if (contributionDates[dateStr]) {
                            const amount = contributionDates[dateStr];
                            if (amount > 500) {
                                dayDiv.classList.add("employer-contribution");
                            } else {
                                dayDiv.classList.add("low-income-benefit");
                            }
                            const amountDiv = document.createElement("div");
                            amountDiv.className = "amount";
                            amountDiv.textContent = `$${amount}`;
                            dayDiv.appendChild(amountDiv);
                        }

                        if (isEverySecondThursday(currentDate)) {
                            dayDiv.classList.add("highlight-thursday");
                        }

                        daysDiv.appendChild(dayDiv);
                    }

                    monthDiv.appendChild(daysDiv);
                    container.appendChild(monthDiv);
                }
            }
        }

        function updateCalendar() {
            // Clear existing calendar
            const container = document.getElementById('calendar');
            container.innerHTML = '';

            const months = [
                "January", "February", "March", "April",
                "May", "June", "July", "August",
                "September", "October", "November", "December"
            ];

            // Get the current year
            const year = new Date().getFullYear();

            // Calculate payment cycle dates
            let cycleDates = [];
            if (paymentCycle) {
                let currentDate = new Date(year, 0, 1); // Start from January 1st
                while (currentDate.getFullYear() === year) {
                    switch (paymentCycle) {
                        case 'weekly':
                            cycleDates.push(new Date(currentDate));
                            currentDate.setDate(currentDate.getDate() + 7);
                            break;
                        case 'biweekly':
                            cycleDates.push(new Date(currentDate));
                            currentDate.setDate(currentDate.getDate() + 14);
                            break;
                        case 'quadweekly':
                            cycleDates.push(new Date(currentDate));
                            currentDate.setDate(currentDate.getDate() + 28);
                            break;
                        case 'monthly':
                            cycleDates.push(new Date(currentDate));
                            currentDate.setMonth(currentDate.getMonth() + 1);
                            break;
                        case 'quarterly':
                            cycleDates.push(new Date(currentDate));
                            currentDate.setMonth(currentDate.getMonth() + 3);
                            break;
                        case 'halfyear':
                            cycleDates.push(new Date(currentDate));
                            currentDate.setMonth(currentDate.getMonth() + 6);
                            break;
                        case 'yearly':
                            cycleDates.push(new Date(currentDate));
                            currentDate.setFullYear(currentDate.getFullYear() + 1);
                            break;
                    }
                }
            }

            // Create calendar for each month
            for (let month = 0; month < 12; month++) {
                const monthDiv = document.createElement('div');
                monthDiv.className = 'month';

                // Add month title
                const monthTitle = document.createElement('div');
                monthTitle.className = 'month-title';
                monthTitle.textContent = `${months[month]} ${year}`;
                monthDiv.appendChild(monthTitle);

                // Add weekday headers
                const weekdays = document.createElement('div');
                weekdays.className = 'weekdays';
                'Sun,Mon,Tue,Wed,Thu,Fri,Sat'.split(',').forEach(day => {
                    const dayDiv = document.createElement('div');
                    dayDiv.textContent = day;
                    weekdays.appendChild(dayDiv);
                });
                monthDiv.appendChild(weekdays);

                // Create days grid
                const daysDiv = document.createElement('div');
                daysDiv.className = 'days';

                // Calculate first day of month and last day
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);

                // Add empty cells for days before the first day of month
                for (let i = 0; i < firstDay.getDay(); i++) {
                    const emptyDay = document.createElement('div');
                    emptyDay.className = 'day';
                    daysDiv.appendChild(emptyDay);
                }

                // Add actual days
                for (let day = 1; day <= lastDay.getDate(); day++) {
                    const dayDiv = document.createElement('div');
                    dayDiv.className = 'day';
                    dayDiv.textContent = day;

                    // Format date string to match contribution data format
                    const dateStr = `${day.toString().padStart(2, '0')}.${(month + 1).toString().padStart(2, '0')}`;

                    // Check if this date has a contribution
                    if (contributionData[dateStr]) {
                        const amount = contributionData[dateStr];
                        if (amount > 500) {
                            dayDiv.classList.add('employer-contribution');
                        } else {
                            dayDiv.classList.add('low-income-benefit');
                        }

                        // Add amount label
                        const amountDiv = document.createElement('div');
                        amountDiv.className = 'amount';
                        amountDiv.textContent = `$${amount.toFixed(2)}`;
                        dayDiv.appendChild(amountDiv);
                    }

                    // Check if this date is in the payment cycle
                    const currentDate = new Date(year, month, day);
                    if (cycleDates.some(cycleDate =>
                        cycleDate.getDate() === currentDate.getDate() &&
                        cycleDate.getMonth() === currentDate.getMonth()
                    )) {
                        dayDiv.classList.add('payment-cycle');
                    }

                    daysDiv.appendChild(dayDiv);
                }

                monthDiv.appendChild(daysDiv);
                container.appendChild(monthDiv);
            }
        }

        function updateCalendar() {
            // Clear existing calendar
            const container = document.getElementById('calendar');
            container.innerHTML = '';

            const months = [
                "January", "February", "March", "April",
                "May", "June", "July", "August",
                "September", "October", "November", "December"
            ];

            // Get the current year
            const year = new Date().getFullYear();

            // Calculate payment cycle dates
            let cycleDates = [];
            if (paymentCycle) {
                let currentDate = new Date(year, 0, 1); // Start from January 1st
                while (currentDate.getFullYear() === year) {
                    switch (paymentCycle) {
                        case 'weekly':
                            cycleDates.push(new Date(currentDate));
                            currentDate.setDate(currentDate.getDate() + 7);
                            break;
                        case 'biweekly':
                            cycleDates.push(new Date(currentDate));
                            currentDate.setDate(currentDate.getDate() + 14);
                            break;
                        case 'quadweekly':
                            cycleDates.push(new Date(currentDate));
                            currentDate.setDate(currentDate.getDate() + 28);
                            break;
                        case 'monthly':
                            cycleDates.push(new Date(currentDate));
                            currentDate.setMonth(currentDate.getMonth() + 1);
                            break;
                        case 'quarterly':
                            cycleDates.push(new Date(currentDate));
                            currentDate.setMonth(currentDate.getMonth() + 3);
                            break;
                        case 'halfyear':
                            cycleDates.push(new Date(currentDate));
                            currentDate.setMonth(currentDate.getMonth() + 6);
                            break;
                        case 'yearly':
                            cycleDates.push(new Date(currentDate));
                            currentDate.setFullYear(currentDate.getFullYear() + 1);
                            break;
                    }
                }
            }

            // Create calendar for each month
            for (let month = 0; month < 12; month++) {
                const monthDiv = document.createElement('div');
                monthDiv.className = 'month';

                // Add month title
                const monthTitle = document.createElement('div');
                monthTitle.className = 'month-title';
                monthTitle.textContent = `${months[month]} ${year}`;
                monthDiv.appendChild(monthTitle);

                // Add weekday headers
                const weekdays = document.createElement('div');
                weekdays.className = 'weekdays';
                'Sun,Mon,Tue,Wed,Thu,Fri,Sat'.split(',').forEach(day => {
                    const dayDiv = document.createElement('div');
                    dayDiv.textContent = day;
                    weekdays.appendChild(dayDiv);
                });
                monthDiv.appendChild(weekdays);

                // Create days grid
                const daysDiv = document.createElement('div');
                daysDiv.className = 'days';

                // Calculate first day of month and last day
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);

                // Add empty cells for days before the first day of month
                for (let i = 0; i < firstDay.getDay(); i++) {
                    const emptyDay = document.createElement('div');
                    emptyDay.className = 'day';
                    daysDiv.appendChild(emptyDay);
                }

                // Add actual days
                for (let day = 1; day <= lastDay.getDate(); day++) {
                    const dayDiv = document.createElement('div');
                    dayDiv.className = 'day';
                    dayDiv.textContent = day;

                    // Format date string to match contribution data format
                    const dateStr = `${day.toString().padStart(2, '0')}.${(month + 1).toString().padStart(2, '0')}`;

                    // Check if this date has a contribution
                    if (contributionData[dateStr]) {
                        const amount = contributionData[dateStr];
                        if (amount > 500) {
                            dayDiv.classList.add('employer-contribution');
                        } else {
                            dayDiv.classList.add('low-income-benefit');
                        }

                        // Add amount label
                        const amountDiv = document.createElement('div');
                        amountDiv.className = 'amount';
                        amountDiv.textContent = `$${amount.toFixed(2)}`;
                        dayDiv.appendChild(amountDiv);
                    }

                    // Check if this date is in the payment cycle
                    const currentDate = new Date(year, month, day);
                    if (cycleDates.some(cycleDate =>
                        cycleDate.getDate() === currentDate.getDate() &&
                        cycleDate.getMonth() === currentDate.getMonth()
                    )) {
                        dayDiv.classList.add('payment-cycle');
                    }

                    daysDiv.appendChild(dayDiv);
                }

                monthDiv.appendChild(daysDiv);
                container.appendChild(monthDiv);
            }
        }
    </script>
    <style>
        body {
            font-family: Arial;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .controls {
            margin-bottom: 20px;
            padding: 15px;
            background: #f5f5f5;
            border-radius: 5px;
        }

        .controls input,
        .controls select {
            margin: 5px;
            padding: 5px;
        }

        .controls button {
            margin: 5px;
            padding: 5px 10px;
        }

        #analysis table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        #analysis td {
            padding: 8px;
            border: 1px solid #ddd;
        }

        #analysis tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .calendar-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
        }

        .month {
            border: 1px solid #ccc;
            padding: 10px;
            border-radius: 5px;
        }

        .month-title {
            text-align: center;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }

        .weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            text-align: center;
            font-weight: bold;
            color: #666;
        }

        .days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            text-align: center;
        }

        .day {
            padding: 5px;
            border: 1px solid #eee;
            position: relative;
        }

        .highlight-thursday {
            background-color: #90caf9;
            font-weight: bold;
        }

        .employer-contribution {
            background-color: #4CAF50;
            color: white;
            font-weight: bold;
        }

        .low-income-benefit {
            background-color: #FF9800;
            color: white;
            font-weight: bold;
        }

        .amount {
            font-size: 10px;
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
        }

        .legend {
            text-align: center;
            margin-top: 20px;
            padding: 10px;
            background: #f5f5f5;
            border-radius: 5px;
        }

        .legend-item {
            display: inline-block;
            margin: 0 10px;
        }

        .legend-color {
            display: inline-block;
            width: 20px;
            height: 20px;
            margin-right: 5px;
            vertical-align: middle;
        }
    </style>
</head>

<body>
    <div class="controls">
        <h2>Super Contribution Analysis Tool</h2>

        <div>
            <h3>Import Data</h3>
            <textarea id="dataInput" rows="4" cols="50"
                placeholder='{"dates": ["01.01", "15.01"], "amounts": [550, 42.17]}'></textarea>
            <button onclick="importData()">Import</button>
        </div>

        <div>
            <h3>Payment Settings</h3>
            <input type="number" id="annualIncome" placeholder="Annual Income" />
            <input type="number" id="superRate" placeholder="Super Rate %" value="11.0" step="0.1" />
            <select id="paymentCycle">
                <option value="">Select Payment Cycle</option>
                <option value="weekly">Weekly</option>
                <option value="biweekly">Bi-weekly</option>
                <option value="quadweekly">4-weekly</option>
                <option value="monthly">Monthly</option>
                <option value="quarterly">Quarterly</option>
                <option value="halfyear">Half-yearly</option>
                <option value="yearly">Yearly</option>
            </select>
            <button onclick="setPaymentCycle()">Update</button>
        </div>
    </div>

    <div id="calendar"></div>
    <div id="analysis"></div>

    <script>
        createCalendar();
    </script>
</body>

</html>